@{
    var X = Html.X();
}

@(
    X.Panel()
        .Cls("card")
        .Listeners(events =>
        {
            events.Hide.Handler = MvcUtils.StringifyScriptBlock(
            @<text>
                <script>
                    this.down('audio').fireEvent('hide');
                    if (this.down('button')) {
                        this.down('button').setText('Play audio');
                    };
                </script>
            </text>);

            events.Show.Handler = MvcUtils.StringifyScriptBlock(
            @<text>
                <script>
                    this.down('audio').fireEvent('show');
                </script>
            </text>);
        })
        .Items(items =>
        {
            items.Add(X.Audio()
                .Url("../resources/audio/crash.mp3")
                .Loop(true)
                .Cls("myAudio"));

            if (RequestManager.IsAndroid)
            {
                items.Add(new Ext.Net.Mobile.Button()
                {
                    ID = "playbtn",
                    Text = "Play audio",
                    Handler = MvcUtils.StringifyScriptBlock(
                    @<text>
                        <script>
                            var audio = this.up().down('audio');
                            if (audio.isPlaying()) {
                                audio.pause();
                                this.setText('Play audio');
                            } else {
                                audio.play();
                                this.setText('Pause audio');
                            };
                        </script>
                    </text>)
                });
            }
        })
        .LayoutConfig(lc =>
        {
            if (RequestManager.IsAndroid)
            {
                lc.Add(
                    X.VBoxLayoutConfig()
                        .Pack(BoxPack.Center)
                        .Align(BoxAlign.Center)
                );
            }
            else
            {
                lc.Add(X.FitLayoutConfig());
            }
        })
)