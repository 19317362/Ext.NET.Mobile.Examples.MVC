@{
    var X = Html.X();
}

@(
 X.Panel()
        .ID("TreeListPanel")
        .Title("TreeList")
        .LayoutConfig(
            X.VBoxLayoutConfig()
                .Align(BoxAlign.Stretch)
        )
        .PreInit(
        @<text>
            <script>
                // set it as a global variable
                window.scripts = {
                    onMicroPressedChange: function (button, pressed) {
                        var treelist = App.TreeList1,
                            navBtn = App.NavButton;

                        treelist.setMicro(pressed);

                        if (pressed) {
                            navBtn.setPressed(true);
                            navBtn.disable();
                            treelist.oldWidth = treelist.getWidth();
                            treelist.setWidth(44);
                        } else {
                            treelist.setWidth(treelist.oldWidth);
                            navBtn.enable();
                        }
                    },

                    onNavPressedChange: function (button, pressed) {
                        var treelist = App.TreeList1;

                        treelist.setExpanderFirst(!pressed);
                        treelist.setUi(pressed ? 'nav' : null);
                    },

                    onSelectionChange: function (treelist, selection) {
                        var path, text;

                        if (selection) {
                            path = selection.getPath("text");
                            path = path.replace(/^\/Root/, "");
                            text = "Selected: " + path;
                        } else {
                            text = "No node selected";
                        }

                        App.TreeListLog.setHtml(text);
                    }
                };
            </script>
        </text>)
        .Items(
            X.Container()
                .Flex(1)
                .Scrollable(ScrollableOption.Vertical)
                .Items(
                    X.Toolbar()
                        .Docked(Dock.Top)
                        .Border(false)
                        .Items(
                            X.SegmentedButton()
                                .AllowMultiple(true)
                                .Items(
                                    X.Button()
                                        .ID("NavButton")
                                        .Text("Nav")
                                        .Listeners(l => l.PressedChange.Handler = "scripts.onNavPressedChange(item, value, oldValue);"),
                                    X.Button()
                                        .ID("MicroButton")
                                        .Text("Micro")
                                        .Listeners(l => l.PressedChange.Handler = "scripts.onMicroPressedChange(item, value, oldValue);")
                                )
                        ),
                    X.TreeList()
                        .ID("TreeList1")
                        .Store(
                            X.TreeStore()
                                .Root(
                                    X.Node()
                                        .Expanded(true)
                                        .Children(
                                            X.Node()
                                                .Text("Home")
                                                .IconCls("x-fa fa-home")
                                                .Children(
                                                    X.Node()
                                                        .Text("Messages")
                                                        .IconCls("x-fa fa-inbox")
                                                        .Leaf(true),
                                                    X.Node()
                                                        .Text("Archive")
                                                        .IconCls("x-fa fa-database")
                                                        .Children(
                                                            X.Node()
                                                                .Text("First")
                                                                .IconCls("x-fa fa-music")
                                                                .Leaf(true),
                                                            X.Node()
                                                                .Text("No Icon")
                                                                .Leaf(true)
                                                        ),
                                                    X.Node()
                                                        .Text("Music")
                                                        .IconCls("x-fa fa-music")
                                                        .Leaf(true),
                                                    X.Node()
                                                        .Text("Video")
                                                        .IconCls("x-fa fa-film")
                                                        .Leaf(true)
                                                ),
                                            X.Node()
                                                .Text("Users")
                                                .IconCls("x-fa fa-user")
                                                .Children(
                                                    X.Node()
                                                        .Text("Tagged")
                                                        .IconCls("x-fa fa-tag")
                                                        .Leaf(true),
                                                    X.Node()
                                                        .Text("Inactive")
                                                        .IconCls("x-fa fa-trash")
                                                        .Leaf(true)
                                                ),
                                            X.Node()
                                                .Text("Groups")
                                                .IconCls("x-fa fa-group")
                                                .Leaf(true),
                                            X.Node()
                                                .Text("Settings")
                                                .IconCls("x-fa fa-wrench")
                                                .Children(
                                                    X.Node()
                                                        .Text("Sharing")
                                                        .IconCls("x-fa fa-share-alt")
                                                        .Leaf(true),
                                                    X.Node()
                                                        .Text("Network")
                                                        .IconCls("x-fa fa-signal")
                                                        .Leaf(true)
                                                )
                                        )
                                )
                        )
                        .Listeners(l =>
                        {
                            l.SelectionChange.Handler = "scripts.onSelectionChange(tree, selection);";
                        })
                ),
            X.Component()
                .ID("TreeListLog")
                .Cls("treelist-log")
                .Padding(10)
                .Height(50)
                .Html("No node selected")
        )
)